## Description: NXLog CE configuration for Windows Event Log (WEL) and Microsoft DNS Debug Log collection in Snare over Syslog format.
## Instructions: Copy the below Input, Output instances and Route sections placing them at the end of the default NXLog CE configuration. Next, replace <TDR_DC_IP> with your TDR Data Collector IP address and save the configuration file. Last, start the "nxlog" service and validate no errors are seen in %ROOT%\data\nxlog.log where %ROOT% is your defined ROOT path for NXLog CE. 
## Version: 2.10.2150_20200901a
-----------------------

<Input MSWINEVENTLOGIN>
# Uncomment im_msvistalog for Windows Vista/2008 and later
    Module      im_msvistalog

# For windows 2003 and earlier use the following:
#   Module      im_mseventlog
</Input>

<Input MSDNSLOGIN>
 Module im_file
 File 'C:\Windows\Sysnative\dns\dns.log'
# 32-bit applications can access the native system directory by substituting %windir%\Sysnative for %windir%\System32. WOW64 recognizes Sysnative as a special alias used to indicate that the file system should not redirect the access. This mechanism is flexible and easy to use, therefore, it is the recommended mechanism to bypass file system redirection. Note that 64-bit applications cannot use the Sysnative alias as it is a virtual directory not a real one.
 InputType LineBased
 SavePos TRUE
 ReadFromLast FALSE
 PollInterval 1
# The input is assumed to contain log messages separated by newlines. Thus if an LF (\n) or CRLF (\r\n) is found, the function considers that it has reached the end of the log message.
 Exec if $raw_event == '' drop();  ##drops blank messages
 Exec $SourceName = "MSDNSLog";$Message = $raw_event;
</Input>

<Output MSWINEVENTLOGOUT>
    Module      om_udp
    Host        192.168.10.10
    Port        514
# Transmit in Snare format on local6.info
    Exec        $SyslogFacilityValue = 22;to_syslog_snare();
</Output>

<Output W3SVCOUT>
    Module      om_udp
    Host        192.168.10.10
    Port        514
# Create our RFC3164 compliant syslog line and transmit on local5.info
    Exec        $SyslogFacilityValue = 21;$Severity = 'INFO';to_syslog_bsd();

</Output>

<Output MSWINEVENTLOGOUT2>
    Module      om_udp
    Host        192.168.10.11
    Port        514
# Transmit in Snare format on local6.info
    Exec        $SyslogFacilityValue = 22;to_syslog_snare();
</Output>

<Output W3SVCOUT2>
    Module      om_udp
    Host        192.168.10.11
    Port        514
# Create our RFC3164 compliant syslog line and transmit on local5.info
    Exec        $SyslogFacilityValue = 21;$Severity = 'INFO';to_syslog_bsd();

</Output>

<Route 1>
    Path	MSWINEVENTLOGIN => MSWINEVENTLOGOUT
</Route>

<Route 2>
    Path	MSDNSLOGIN => W3SVCOUT
</Route>

<Route 1>
    Path	MSWINEVENTLOGIN => MSWINEVENTLOGOUT2
</Route>

<Route 2>
    Path	MSDNSLOGIN => W3SVCOUT2
</Route>